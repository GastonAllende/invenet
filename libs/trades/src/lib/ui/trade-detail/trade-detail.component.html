@if (trade(); as t) {
  <section class="trade-detail-layout">
    <p-card styleClass="trade-hero-card">
      <div class="trade-hero">
        <div class="trade-hero-main">
          <h2 class="trade-symbol">{{ t.symbol }}</h2>
          <p class="trade-meta">
            Opened {{ t.openedAt | date: 'short' }}
            @if (t.closedAt) {
              • Closed {{ t.closedAt | date: 'short' }}
            }
          </p>
          <div class="trade-tags">
            <p-tag [value]="t.direction" [severity]="getDirectionSeverity(t.direction)"></p-tag>
            <p-tag [value]="t.status" [severity]="getStatusSeverity(t.status)"></p-tag>
            @if (t.isArchived) {
              <p-tag value="ARCHIVED" severity="warn"></p-tag>
            }
          </div>
        </div>

        <div class="trade-actions">
          <p-button label="Back to Journal" severity="secondary" [text]="true" (onClick)="onBack()"></p-button>
          <p-button label="Edit" icon="pi pi-pencil" size="small" (onClick)="onEdit()"></p-button>
          @if (!t.isArchived) {
            <p-button label="Archive" icon="pi pi-folder" severity="danger" [outlined]="true" size="small" (onClick)="onArchive()"></p-button>
          } @else {
            <p-button label="Unarchive" icon="pi pi-refresh" severity="success" [outlined]="true" size="small" (onClick)="onUnarchive()"></p-button>
          }
        </div>
      </div>
    </p-card>

    <div class="trade-content-grid">
      <p-card styleClass="trade-detail-card">
        <ng-template pTemplate="title">Execution Details</ng-template>
        <div class="detail-rows">
          <div class="detail-row">
            <span class="detail-label">Account</span>
            <div class="detail-value-wrap">
              <span class="detail-value">{{ getAccountName(t.accountId) }}</span>
              <span class="trade-code">{{ t.accountId }}</span>
            </div>
          </div>
          <p-divider></p-divider>
          <div class="detail-row">
            <span class="detail-label">Strategy</span>
            <span class="detail-value">
              {{ t.strategyName ?? '—' }}
              @if (t.strategyVersionNumber) {
                v{{ t.strategyVersionNumber }}
              }
            </span>
          </div>
          <p-divider></p-divider>
          <div class="detail-row">
            <span class="detail-label">Entry Price</span>
            <span class="detail-value">{{ t.entryPrice }}</span>
          </div>
          <p-divider></p-divider>
          <div class="detail-row">
            <span class="detail-label">Exit Price</span>
            <span class="detail-value">{{ t.exitPrice ?? '—' }}</span>
          </div>
          <p-divider></p-divider>
          <div class="detail-row">
            <span class="detail-label">Quantity</span>
            <span class="detail-value">{{ t.quantity }}</span>
          </div>
          <p-divider></p-divider>
          <div class="detail-row">
            <span class="detail-label">R-Multiple</span>
            <span class="detail-value">{{ t.rMultiple ?? '—' }}</span>
          </div>
          <p-divider></p-divider>
          <div class="detail-row">
            <span class="detail-label">P&amp;L</span>
            <span class="detail-value">{{ t.pnl ?? '—' }}</span>
          </div>
          <p-divider></p-divider>
          <div class="detail-row">
            <span class="detail-label">Tags</span>
            <span class="detail-value">{{ t.tags?.join(', ') || '—' }}</span>
          </div>
        </div>
      </p-card>

      <p-card styleClass="trade-detail-card">
        <ng-template pTemplate="title">Notes</ng-template>
        <p class="trade-notes">{{ t.notes || 'No notes recorded.' }}</p>
      </p-card>
    </div>
  </section>
}
