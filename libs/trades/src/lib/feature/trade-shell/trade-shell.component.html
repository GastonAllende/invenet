<div class="trade-shell entity-shell">
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>

  @if (journalMode() === 'list') {
    <lib-trade-list
      [trades]="trades()"
      [isLoading]="isLoading()"
      [accounts]="accounts()"
      [strategies]="strategies()"
      [selectedAccountId]="activeAccountId()"
      [includeArchived]="includeArchived()"
      (filtersChange)="onFiltersChange($event)"
      (includeArchivedChange)="onIncludeArchivedChange($event)"
      (logFull)="onLogFull()"
      (quickLog)="onQuickLog()"
      (view)="onView($event)"
      (archive)="onArchive($event)"
      (unarchive)="onUnarchive($event)"
    ></lib-trade-list>
  }

  @if (journalMode() === 'new' || journalMode() === 'edit') {
    <section class="page-header entity-header">
      <h1 class="page-title entity-title">
        {{ journalMode() === 'edit' ? 'Edit Trade' : 'Log Trade' }}
      </h1>
      <p class="page-subtitle entity-subtitle">
        {{ journalMode() === 'edit'
          ? 'Update execution and journal details for this trade.'
          : 'Capture complete trade context for later review.' }}
      </p>
    </section>

    <lib-trade-form
      [mode]="journalMode() === 'edit' ? 'edit' : 'create'"
      [trade]="selectedTradeDetail()"
      [accounts]="accounts()"
      [defaultAccountId]="activeAccountId()"
      [strategies]="strategies()"
      [isLoading]="isLoading()"
      (save)="onSaveTrade($event)"
      (formCancel)="onCancelForm()"
    ></lib-trade-form>
  }

  @if (journalMode() === 'detail') {
    <lib-trade-detail
      [trade]="selectedTradeDetail()"
      [accounts]="accounts()"
      (edit)="onEditFromDetail()"
      (archive)="onArchiveFromDetail()"
      (unarchive)="onUnarchiveFromDetail()"
      (back)="onBackToJournal()"
    ></lib-trade-detail>
  }
</div>
